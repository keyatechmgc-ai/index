<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¯Ø¹ÙˆØ© Ø²ÙØ§Ù Ù…Ù„ÙƒÙŠØ© | Ø³ÙŠØ§Ø¯Ø© Ø§Ù„Ù†Ù‚ÙŠØ¨</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;700&family=Reem+Kufi:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root { --gold: #c5a059; --dark-red: #590d22; --white: #ffffff; }
        body { font-family: 'Cairo', sans-serif; background: #fff5f7; margin: 0; color: var(--dark-red); overflow-x: hidden; }
        
        /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ø®Ù„ÙÙŠØ© ÙˆØ§Ù„Ø³ØªØ§Ø¦Ø± */
        .hero { background: linear-gradient(rgba(89, 13, 34, 0.8), rgba(89, 13, 34, 0.8)), url('https://www.transparenttextures.com/patterns/gold-floral.png');
                height: 400px; display: flex; flex-direction: column; align-items: center; justify-content: center; color: var(--gold); border-bottom: 5px solid var(--gold); }
        h1 { font-family: 'Reem Kufi', sans-serif; font-size: 3rem; margin: 0; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
        
        /* Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø§Ø³ÙŠ */
        .countdown { display: flex; justify-content: center; gap: 15px; margin-top: -50px; }
        .time-box { background: var(--white); width: 80px; height: 90px; border-radius: 15px; display: flex; flex-direction: column; 
                    align-items: center; justify-content: center; box-shadow: 0 10px 25px rgba(0,0,0,0.1); border: 2px solid var(--gold); }
        .time-box span { font-size: 24px; font-weight: bold; color: var(--dark-red); }
        .time-box label { font-size: 12px; color: var(--gold); font-weight: bold; }

        /* ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¶ÙˆØ± (RSVP) */
        .rsvp-section { max-width: 600px; margin: 40px auto; background: white; padding: 30px; border-radius: 30px; border: 1px solid var(--gold); }
        .rsvp-options { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin: 20px 0; }
        .rsvp-btn { padding: 10px 20px; border: 2px solid var(--gold); border-radius: 25px; cursor: pointer; background: none; font-weight: bold; transition: 0.3s; }
        .rsvp-btn.active { background: var(--gold); color: white; }

        /* Ø§Ù„Ø£Ù†ÙŠÙ…ÙŠØ´Ù† */
        .floating-rose { position: fixed; pointer-events: none; z-index: 100; font-size: 25px; animation: fall 4s linear infinite; }
        @keyframes fall { to { transform: translateY(110vh) rotate(360deg); opacity: 0; } }

        /* Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø®ÙÙŠØ© */
        #admin-panel { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 9999; padding: 40px; box-sizing: border-box; }
        .couple-img { width: 200px; height: 200px; border-radius: 50%; border: 6px solid var(--gold); object-fit: cover; margin-top: 20px; box-shadow: 0 0 20px var(--gold); }
    </style>
</head>
<body>

<div class="hero">
    <img id="mainImage" src="" class="couple-img" style="display:none;">
    <h1>M & E</h1>
    <p style="font-size: 1.2rem; font-weight: 300;">Ù†ØªØ´Ø±Ù Ø¨Ø¯Ø¹ÙˆØªÙƒÙ… Ù„Ù…Ø´Ø§Ø±ÙƒØªÙ†Ø§ ÙØ±Ø­Ø© Ø§Ù„Ø¹Ù…Ø±</p>
</div>

<div class="countdown">
    <div class="time-box"><span id="days">00</span><label>ÙŠÙˆÙ…</label></div>
    <div class="time-box"><span id="hours">00</span><label>Ø³Ø§Ø¹Ø©</label></div>
    <div class="time-box"><span id="minutes">00</span><label>Ø¯Ù‚ÙŠÙ‚Ø©</label></div>
    <div class="time-box" onclick="adminAuth()" style="cursor:pointer"><span id="seconds">00</span><label>Ø«Ø§Ù†ÙŠØ©</label></div>
</div>

<div class="rsvp-section">
    <h3 style="text-align: center;">ØªØ´Ø±ÙŠÙ Ø³ÙŠØ§Ø¯ØªÙƒÙ… Ù„Ù„ÙØ±Ø­ â¤ï¸</h3>
    <input type="text" id="userName" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ±ÙŠÙ…">
    
    <div class="rsvp-options">
        <button class="rsvp-btn" onclick="setRSVP(this, 'Ø¨Ø¥Ø°Ù† Ø§Ù„Ù„Ù‡ Ø³Ø£ÙƒÙˆÙ† Ù…Ù† Ø§Ù„Ø­Ø§Ø¶Ø±ÙŠÙ†')">Ø¨Ø¥Ø°Ù† Ø§Ù„Ù„Ù‡ Ø³Ø£ÙƒÙˆÙ† Ù…Ù† Ø§Ù„Ø­Ø§Ø¶Ø±ÙŠÙ†</button>
        <button class="rsvp-btn" onclick="setRSVP(this, 'Ø³Ø£Ø¨Ø°Ù„ Ø¬Ù‡Ø¯ÙŠ Ù„Ù„ØªØ´Ø±ÙŠÙ')">Ø³Ø£Ø¨Ø°Ù„ Ø¬Ù‡Ø¯ÙŠ Ù„Ù„ØªØ´Ø±ÙŠÙ</button>
        <button class="rsvp-btn" onclick="setRSVP(this, 'Ø£Ø¹ØªØ°Ø± Ù„Ø¸Ø±ÙˆÙ Ù‚Ù‡Ø±ÙŠØ©')">Ø£Ø¹ØªØ°Ø± Ù„Ø¸Ø±ÙˆÙ Ù‚Ù‡Ø±ÙŠØ©</button>
    </div>
    
    <textarea id="userMsg" placeholder="ÙƒÙ„Ù…Ø© ØªÙ‡Ù†Ø¦Ø© Ù„Ø³ÙŠØ§Ø¯Ø© Ø§Ù„Ù†Ù‚ÙŠØ¨ ÙˆØ¹Ø±ÙˆØ³Ù‡..."></textarea>
    <button onclick="sendInvite()" style="background: var(--dark-red); color: white; width: 100%; padding: 15px; border-radius: 30px; border: none; font-size: 1.1rem; cursor: pointer;">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„</button>
    
    <div id="commentsList" style="margin-top: 30px;"></div>
</div>

<div id="admin-panel">
    <h2 style="color: var(--gold);">âš™ï¸ Ø¥Ø¯Ø§Ø±Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­ÙÙ„</h2>
    <input type="datetime-local" id="targetDate">
    <input type="text" id="imgUrl" placeholder="Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø§Ù„Ø¹Ø±ÙˆØ³ÙŠÙ† Ø§Ù„Ù…Ø¨Ø§Ø´Ø±">
    <button onclick="updateSettings()" style="background: green; color:white; padding: 15px;">Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª</button>
    <button onclick="document.getElementById('admin-panel').style.display='none'" style="background: #666; color:white; padding: 15px;">Ø±Ø¬ÙˆØ¹</button>
    <hr>
    <div id="adminComments"></div>
</div>

<script>
    // Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø§Ù„Ù…Ø£Ø®ÙˆØ°Ø© Ù…Ù† Ø§Ù„ØµÙˆØ±Ø©
    const firebaseConfig = {
        apiKey: "AIzaSyCF-kh6JgAbhroue7cKRdMZjwYV8m2c6Uw",
        authDomain: "engagmen.firebaseapp.com",
        databaseURL: "https://engagmen-default-rtdb.firebaseio.com",
        projectId: "engagmen",
        storageBucket: "engagmen.firebasestorage.app",
        messagingSenderId: "286100738965",
        appId: "1:286100738965:web:3f5be0307dca5927e5dc9c"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // ØªØ´ØºÙŠÙ„ Ø§Ù„Ø£Ù†Ø¸Ù…Ø© ÙÙˆØ±Ø§Ù‹
    let tTime = 0;
    let selectedRSVP = "";

    function setRSVP(btn, val) {
        document.querySelectorAll('.rsvp-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        selectedRSVP = val;
    }

    // Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª (ØªØ¹Ù…Ù„ Ø£ÙˆØªÙˆÙ…Ø§ØªÙŠÙƒ)
    db.ref('settings').on('value', s => {
        const v = s.val();
        if(v) {
            if(v.date) tTime = new Date(v.date).getTime();
            if(v.image) { 
                document.getElementById('mainImage').src = v.image;
                document.getElementById('mainImage').style.display = 'block';
            }
        }
    });

    // Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø²Ù…Ù†ÙŠ (ÙŠØ¹Ù…Ù„ Ø£ÙˆØªÙˆÙ…Ø§ØªÙŠÙƒ)
    setInterval(() => {
        const diff = tTime - Date.now();
        if(diff <= 0) return;
        document.getElementById('days').innerText = Math.floor(diff/(1000*60*60*24));
        document.getElementById('hours').innerText = Math.floor((diff%(1000*60*60*24))/(1000*60*60));
        document.getElementById('minutes').innerText = Math.floor((diff%(1000*60*60))/(1000*60));
        document.getElementById('seconds').innerText = Math.floor((diff%(1000*60))/1000);
    }, 1000);

    // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ ÙˆØ§Ù„Ø­Ø¶ÙˆØ±
    function sendInvite() {
        const n = document.getElementById('userName').value;
        const m = document.getElementById('userMsg').value;
        if(n && selectedRSVP) {
            db.ref('comments').push({ name: n, msg: m, status: selectedRSVP });
            document.getElementById('userName').value = "";
            document.getElementById('userMsg').value = "";
            alert("ØªÙ… ØªØ³Ø¬ÙŠÙ„ ØªØ´Ø±ÙŠÙÙƒÙ… Ø¨Ù†Ø¬Ø§Ø­ â¤ï¸");
        } else { alert("ÙŠØ±Ø¬Ù‰ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ø®ØªÙŠØ§Ø± Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø¶ÙˆØ±"); }
    }

    // Ø¬Ù„Ø¨ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª (ØªØ¹Ù…Ù„ Ø£ÙˆØªÙˆÙ…Ø§ØªÙŠÙƒ)
    db.ref('comments').on('value', s => {
        const list = document.getElementById('commentsList');
        const adm = document.getElementById('adminComments');
        list.innerHTML = ''; adm.innerHTML = '<h3>ÙƒØ´Ù Ø§Ù„Ø­Ø¶ÙˆØ±:</h3>';
        s.forEach(c => {
            const data = c.val();
            list.innerHTML += `<div style="background:#fff; padding:15px; border-radius:15px; margin:10px 0; border-right:4px solid var(--gold);">
                <b>${data.name}</b>: ${data.msg} <br> <small style="color:var(--gold)">Ø§Ù„Ø­Ø§Ù„Ø©: ${data.status}</small></div>`;
            adm.innerHTML += `<div style="padding:10px; border-bottom:1px solid #ddd;">
                <button onclick="db.ref('comments/${c.key}').remove()" style="background:red; color:white;">Ø­Ø°Ù</button> 
                ${data.name} - ${data.status}</div>`;
        });
    });

    // Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ø¯Ù…Ù† Ø§Ù„Ù…Ø®ÙÙŠ
    let clicks = 0;
    function adminAuth() { clicks++; if(clicks>=10) { document.getElementById('admin-panel').style.display='block'; clicks=0; } }

    function updateSettings() {
        const d = document.getElementById('targetDate').value;
        const i = document.getElementById('imgUrl').value;
        db.ref('settings').update({ date: d, image: i }).then(() => alert("ØªÙ… Ø§Ù„Ø­ÙØ¸ ÙŠØ§ Ø³ÙŠØ§Ø¯Ø© Ø§Ù„Ù†Ù‚ÙŠØ¨"));
    }

    // Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ø§Ù„ÙˆØ±Ø¯
    setInterval(() => {
        const rose = document.createElement('div');
        rose.classList.add('floating-rose');
        rose.innerHTML = 'ğŸŒ¸';
        rose.style.left = Math.random() * 100 + 'vw';
        rose.style.animationDuration = (Math.random() * 3 + 2) + 's';
        document.body.appendChild(rose);
        setTimeout(() => rose.remove(), 4000);
    }, 600);
</script>
</body>
</html>
