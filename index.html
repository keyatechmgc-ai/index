<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¯Ø¹ÙˆØ© Ø²ÙØ§Ù Ù…Ù„ÙƒÙŠØ© | Ø³ÙŠØ§Ø¯Ø© Ø§Ù„Ù†Ù‚ÙŠØ¨</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@700&family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* ØªØµÙ…ÙŠÙ… ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠ ÙØ§Ø®Ø± */
        :root { --gold: #D4AF37; --royal-red: #600000; --bg: #fdfbfb; }
        body { font-family: 'Cairo', sans-serif; background: var(--bg); margin: 0; color: #333; overflow-x: hidden; }
        
        /* Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ù…Ù„ÙƒÙŠ */
        .royal-header { 
            background: linear-gradient(rgba(96, 0, 0, 0.9), rgba(96, 0, 0, 0.9)), url('https://www.transparenttextures.com/patterns/gold-floral.png');
            padding: 60px 20px; text-align: center; color: var(--gold); border-bottom: 8px double var(--gold); 
        }
        .royal-header h1 { font-family: 'Amiri', serif; font-size: 3.5rem; margin: 0; letter-spacing: 2px; }
        
        /* Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙØ®Ù… */
        .countdown-container { display: flex; justify-content: center; gap: 15px; margin-top: -40px; }
        .counter-card { 
            background: white; width: 85px; padding: 15px 5px; border-radius: 10px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.15); border: 2px solid var(--gold);
        }
        .counter-card span { display: block; font-size: 28px; font-weight: bold; color: var(--royal-red); }
        .counter-card label { font-size: 14px; color: var(--gold); font-weight: bold; }

        /* Ø§Ù„Ø£Ù‚Ø³Ø§Ù… */
        .section-card { 
            max-width: 600px; margin: 50px auto; background: white; padding: 30px; 
            border-radius: 2px; border: 1px solid #eee; position: relative;
            box-shadow: 0 0 40px rgba(0,0,0,0.05);
        }
        .section-card::before { content: ""; position: absolute; top: 10px; left: 10px; right: 10px; bottom: 10px; border: 1px solid var(--gold); pointer-events: none; }

        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø­Ø¶ÙˆØ± */
        .rsvp-grid { display: grid; grid-template-columns: 1fr; gap: 10px; margin: 25px 0; }
        .rsvp-option { 
            padding: 15px; border: 1px solid #ddd; cursor: pointer; transition: 0.3s; 
            font-weight: bold; background: #fff; color: var(--royal-red);
        }
        .rsvp-option:hover, .rsvp-option.active { background: var(--royal-red); color: white; border-color: var(--royal-red); }

        /* Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ø§Ù„ÙˆØ±Ø¯ */
        .flower { position: fixed; top: -10%; font-size: 20px; z-index: 1000; pointer-events: none; animation: fall 5s linear infinite; }
        @keyframes fall { to { transform: translateY(110vh) rotate(360deg); } }

        /* Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª */
        input, textarea { width: 100%; padding: 15px; margin: 10px 0; border: 1px solid #ccc; box-sizing: border-box; font-family: 'Cairo'; }
        .btn-gold { background: var(--gold); color: white; border: none; padding: 18px; width: 100%; font-size: 18px; font-weight: bold; cursor: pointer; }

        /* Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… */
        #admin-panel { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 99999; padding: 40px; overflow-y: auto; box-sizing: border-box; }
        .couple-img { width: 180px; height: 180px; border-radius: 50%; border: 4px solid var(--gold); margin: 20px auto; display: none; object-fit: cover; }
    </style>
</head>
<body>

<div class="royal-header">
    <img id="mainImage" src="" class="couple-img">
    <h1>M & E</h1>
    <p style="font-size: 1.4rem;">ÙØ±Ø­Ø© Ø§Ù„Ø¹Ù…Ø± ØªÙƒØªÙ…Ù„ Ø¨ØªØ´Ø±ÙŠÙÙƒÙ…</p>
</div>

<div class="countdown-container">
    <div class="counter-card"><span id="days">00</span><label>ÙŠÙˆÙ…</label></div>
    <div class="counter-card"><span id="hours">00</span><label>Ø³Ø§Ø¹Ø©</label></div>
    <div class="counter-card"><span id="minutes">00</span><label>Ø¯Ù‚ÙŠÙ‚Ø©</label></div>
    <div class="counter-card" onclick="adminAuth()" style="cursor:pointer"><span id="seconds">00</span><label>Ø«Ø§Ù†ÙŠØ©</label></div>
</div>

<div class="section-card">
    <h2 style="text-align: center; color: var(--royal-red); font-family: 'Amiri';">ØªØ£ÙƒÙŠØ¯ ØªØ´Ø±ÙŠÙ Ø³ÙŠØ§Ø¯ØªÙƒÙ…</h2>
    <input type="text" id="userName" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ±ÙŠÙ… Ù„Ø³ÙŠØ§Ø¯ØªÙƒÙ…">
    
    <div class="rsvp-grid">
        <div class="rsvp-option" onclick="selectRSVP(this, 'Ø¨Ø¥Ø°Ù† Ø§Ù„Ù„Ù‡ Ø³Ø£ÙƒÙˆÙ† Ù…Ù† Ø§Ù„Ø­Ø§Ø¶Ø±ÙŠÙ†')">Ø¨Ø¥Ø°Ù† Ø§Ù„Ù„Ù‡ Ø³Ø£ÙƒÙˆÙ† Ù…Ù† Ø§Ù„Ø­Ø§Ø¶Ø±ÙŠÙ†</div>
        <div class="rsvp-option" onclick="selectRSVP(this, 'Ø³Ø£Ø¨Ø°Ù„ Ø¬Ù‡Ø¯ÙŠ Ù„Ù„ØªØ´Ø±ÙŠÙ')">Ø³Ø£Ø¨Ø°Ù„ Ø¬Ù‡Ø¯ÙŠ Ù„Ù„ØªØ´Ø±ÙŠÙ</div>
        <div class="rsvp-option" onclick="selectRSVP(this, 'Ø£Ø¹ØªØ°Ø± Ù„Ø¸Ø±ÙˆÙ Ù‚Ù‡Ø±ÙŠØ©')">Ø£Ø¹ØªØ°Ø± Ù„Ø¸Ø±ÙˆÙ Ù‚Ù‡Ø±ÙŠØ©</div>
    </div>
    
    <textarea id="userMsg" rows="3" placeholder="ÙƒÙ„Ù…Ø© ØªÙ‡Ù†Ø¦Ø© Ù„Ù„Ø¹Ø±ÙˆØ³ÙŠÙ†..."></textarea>
    <button class="btn-gold" onclick="sendInvite()">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‡Ù†Ø© ÙˆØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¶ÙˆØ±</button>
    
    <div id="commentsList" style="margin-top: 40px;"></div>
</div>

<div id="admin-panel">
    <h2 style="color: var(--royal-red)">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… ÙŠØ§ Ø³ÙŠØ§Ø¯Ø© Ø§Ù„Ù†Ù‚ÙŠØ¨</h2>
    <input type="datetime-local" id="targetDate">
    <input type="text" id="imgUrl" placeholder="Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø§Ù„Ø¹Ø±ÙˆØ³ÙŠÙ†">
    <button onclick="updateSettings()" style="background: green; color:white; padding: 15px;">Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
    <button onclick="document.getElementById('admin-panel').style.display='none'" style="background:#333; color:white; padding:15px;">Ø¥ØºÙ„Ø§Ù‚</button>
    <hr>
    <div id="adminComments"></div>
</div>

<script>
    // Ø¨ÙŠØ§Ù†Ø§ØªÙƒ
    const firebaseConfig = {
        apiKey: "AIzaSyCF-kh6JgAbhroue7cKRdMZjwYV8m2c6Uw",
        authDomain: "engagmen.firebaseapp.com",
        databaseURL: "https://engagmen-default-rtdb.firebaseio.com",
        projectId: "engagmen",
        storageBucket: "engagmen.firebasestorage.app",
        messagingSenderId: "286100738965",
        appId: "1:286100738965:web:3f5be0307dca5927e5dc9c"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let tTime = 0;
    let rsvpStatus = "";

    function selectRSVP(el, val) {
        document.querySelectorAll('.rsvp-option').forEach(opt => opt.classList.remove('active'));
        el.classList.add('active');
        rsvpStatus = val;
    }

    // Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙˆØ±Ø§Ù‹
    db.ref('settings').on('value', s => {
        const v = s.val();
        if(v) {
            if(v.date) { tTime = new Date(v.date).getTime(); document.getElementById('targetDate').value = v.date; }
            if(v.image) { document.getElementById('mainImage').src = v.image; document.getElementById('mainImage').style.display='block'; }
        }
    });

    // Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
    setInterval(() => {
        const diff = tTime - Date.now();
        if(diff <= 0) return;
        document.getElementById('days').innerText = String(Math.floor(diff/(1000*60*60*24))).padStart(2, '0');
        document.getElementById('hours').innerText = String(Math.floor((diff%(1000*60*60*24))/(1000*60*60))).padStart(2, '0');
        document.getElementById('minutes').innerText = String(Math.floor((diff%(1000*60*60))/(1000*60))).padStart(2, '0');
        document.getElementById('seconds').innerText = String(Math.floor((diff%(1000*60))/1000)).padStart(2, '0');
    }, 1000);

    function sendInvite() {
        const n = document.getElementById('userName').value;
        const m = document.getElementById('userMsg').value;
        if(n && rsvpStatus) {
            db.ref('comments').push({ name: n, msg: m, status: rsvpStatus });
            alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ØªÙ‡Ù†Ø¦ØªÙƒÙ… Ø¨Ù†Ø¬Ø§Ø­!");
            document.getElementById('userName').value = ""; document.getElementById('userMsg').value = "";
        } else { alert("ÙŠØ±Ø¬Ù‰ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ø®ØªÙŠØ§Ø± Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø¶ÙˆØ±"); }
    }

    db.ref('comments').on('value', s => {
        const list = document.getElementById('commentsList');
        const adm = document.getElementById('adminComments');
        list.innerHTML = ''; adm.innerHTML = '<h3>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø­Ø¶ÙˆØ±:</h3>';
        s.forEach(c => {
            const d = c.val();
            list.innerHTML += `<div style="border-bottom:1px solid #eee; padding:15px 0;">
                <b style="color:var(--royal-red)">${d.name}</b>: ${d.msg} <br> <small style="color:var(--gold)">${d.status}</small></div>`;
            adm.innerHTML += `<div style="padding:10px; border-bottom:1px solid #ddd;">
                <button onclick="db.ref('comments/${c.key}').remove()" style="background:red; color:white;">Ø­Ø°Ù</button> ${d.name}</div>`;
        });
    });

    let clicks = 0;
    function adminAuth() { clicks++; if(clicks>=10) { document.getElementById('admin-panel').style.display='block'; clicks=0; } }

    function updateSettings() {
        const d = document.getElementById('targetDate').value;
        const i = document.getElementById('imgUrl').value;
        db.ref('settings').update({ date: d, image: i }).then(() => alert("ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª"));
    }

    // ØªØ³Ø§Ù‚Ø· Ø§Ù„ÙˆØ±Ø¯
    setInterval(() => {
        const f = document.createElement('div');
        f.className = 'flower'; f.innerHTML = 'ğŸŒ¸';
        f.style.left = Math.random() * 100 + 'vw';
        f.style.animationDuration = (Math.random() * 2 + 3) + 's';
        document.body.appendChild(f);
        setTimeout(() => f.remove(), 5000);
    }, 800);
</script>
</body>
</html>
